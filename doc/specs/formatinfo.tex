\section{FormatInfo}

A \dfn{format info} is used when formatting a la \code{printf}. It
store the formatting pattern itself and all the format information it
can extract from the pattern.

\subsection{Prototypes}

\begin{itemize}
\item \refObject{Object}
\end{itemize}

\subsection{Construction}

The constructor expects a string as argument, whose syntax is similar
to \code{printf}'s.  It is detailed below.

\begin{urbiscript}
var f = FormatInfo.new("%+2.3d");
[00000001] %+2.3d
\end{urbiscript}

A formatting pattern must one of the following (brackets denote
optional arguments):
\begin{itemize}
\item \verb&%&\var{options} \var{spec}
\item \verb&%|&\var{options}[\var{spec}]\verb&|&
\end{itemize}

\noindent
\var{options} is a sequence of 0 or several of the following
characters:

\begin{tabular}{|c|l|}
  \hline
  \samp{-} & Left alignment.\\
  \samp{=} & Centered alignment.\\
  \samp{+} & Show sign even for positive number.\\
  \samp{ } & If the string does not begin with \samp{+} or \samp{-}, insert
  a space before the converted string.\\
  \samp{0} & Pad with 0's (inserted after sign or base indicator).\\
  \samp{\#} & Show numerical base, and decimal point.\\
%  \samp{'} & Split thousands (\samp{1 000}).\\
  \hline
\end{tabular}

\noindent
\var{spec} is the convertion character and must be one of the
following:

\begin{tabular}{|c|l|}
  \hline
  \samp{s} & Default character, prints normally\\
  \samp{d} & Case modifier: lowercase \\
  \samp{D} & Case modifier: uppercase \\
  \samp{x} & Prints in hexadecimal lowercase \\
  \samp{X} & Prints in hexadecimal uppercase \\
  \samp{o} & Prints in octal\\
 % \samp{b} & Prints in binary\\
  \samp{e} & Prints floats in scientific format\\
  \samp{E} & Prints floats in scientific format uppercase\\
  \samp{f} & Prints floats in fixed format\\
  \hline
\end{tabular}

\subsection{Methods}
\begin{itemize}
\item \lstinline|alignment|\\
  Requested alignment: \lstinline|-1| for left, \lstinline|0| for
  centered, \lstinline|1| for right (default).
\begin{urbiscript}[firstnumber=last]
assert(FormatInfo.new("%s").alignment == 1);
assert(FormatInfo.new("%=s").alignment == 0);
assert(FormatInfo.new("%-s").alignment == -1);
\end{urbiscript}

\item \lstinline|alt|\\
  Whether the ``alternative'' display is requested (\samp{\#}).
\begin{urbiscript}[firstnumber=last]
assert(FormatInfo.new("%s").alt == false);
assert(FormatInfo.new("%#s").alt == true);
\end{urbiscript}

\item \lstinline|group|\\
  Separator to use for thousands.  Corresponds to the \samp{'}
  \var{option}.
\begin{urbiscript}[firstnumber=last]
assert(FormatInfo.new("%s").group == "");
assert(FormatInfo.new("%'s").group == " ");
\end{urbiscript}

\item \lstinline|pad|\\
  The padding character to use for alignment requests.  Defaults to space.
\begin{urbiscript}[firstnumber=last]
assert(FormatInfo.new("%s").pad == " ");
assert(FormatInfo.new("%0s").pad == "0");
\end{urbiscript}

\item \lstinline|pattern|\\
  The pattern given to the constructor.
\begin{urbiscript}[firstnumber=last]
assert(FormatInfo.new("%#'12.8s").pattern == "%#'12.8s");
\end{urbiscript}

\item \lstinline|precision|\\
  When formatting a \refObject{Float}, the maximum number of digits
  after decimal point when in fixed or scientific mode, and in total
  when in default mode.  When formatting other objects with spec-char
  \samp{s}, the conversion string is truncated to the precision first
  chars. The eventual padding to \lstinline|width| is done after
  truncation.
\begin{urbiscript}[firstnumber=last]
assert(FormatInfo.new("%s").precision == 6);
assert(FormatInfo.new("%23.3s").precision == 3);
\end{urbiscript}

\item \lstinline|prefix|\\
  The string to display before positive numbers.  Defaults to empty.
\begin{urbiscript}[firstnumber=last]
assert(FormatInfo.new("%s").prefix == "");
assert(FormatInfo.new("% s").prefix == " ");
assert(FormatInfo.new("%+s").prefix == "+");
\end{urbiscript}

\item \lstinline|spec|\\
  The specification character, regardless of the case conversion
  requests.
\begin{urbiscript}[firstnumber=last]
assert(FormatInfo.new("%s").spec == "s");
assert(FormatInfo.new("%23.3s").spec == "s");
assert(FormatInfo.new("%'X").spec == "x");
\end{urbiscript}

\item \lstinline|uppercase|\\
  Case conversion: \lstinline|-1| for lower case, \lstinline|0| for no
  conversion (default), \lstinline|1| for conversion to uppercase.
  The value depends on the case of specification character, except for
  \samp{\%s} which corresponds to \lstinline|0|.
\begin{urbiscript}[firstnumber=last]
assert(FormatInfo.new("%s").uppercase == 0);
assert(FormatInfo.new("%d").uppercase == -1);
assert(FormatInfo.new("%D").uppercase == 1);
assert(FormatInfo.new("%x").uppercase == -1);
assert(FormatInfo.new("%X").uppercase == 1);
\end{urbiscript}

\item \lstinline|width|\\
  Width requested for alignment.
\begin{urbiscript}[firstnumber=last]
assert(FormatInfo.new("%s").width == 0);
assert(FormatInfo.new("%10s").width == 10);
\end{urbiscript}
\end{itemize}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../urbi-sdk"
%%% End:
